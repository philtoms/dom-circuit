const t=Symbol(),n="undefined"!=typeof window&&window.document,o=(n,[e,...i])=>i.length?o(n[e],i):n[e]&&n[e][t];export const _CURRENT=Symbol();const e=(i,s,c)=>(r,f="",u=1,d=[],y=[],b)=>{c||"function"==typeof s||(c=s||[],s=!1);const l=function(t,n,o,e){return o?s(r=t,e):r=void 0===t?r:d.reduce((o,[e,i,s])=>s?i.call(this,o)&&o:e in r&&t[e]===r[e]?o:e===n?t:e in t?i.call(this,o,t[e]):o,r),s?s(r,e):r},p=(t,[i,p,w])=>{const[h,R,a,g,j]=i.match(/(([\w]+):)?(\s*(.+))?/),[O,$]=j.split(/[\s\.]on/),_=!(O in r)&&a||(O.startsWith("on")?O.slice(2):O).replace(/[#\.\-\[\]\(\)\"\=\^\&\/]/g,""),m=`${f}/${_}`;let x=O.startsWith("/")&&o(t,O.slice(1).split("/"));const C=!w&&O.startsWith("/");if(C)x=[],y.push([i,p,x]);else if(x)return w.forEach(t=>x.push(t)),t;const E=O.startsWith("on")?c:[].concat(c||n).reduce((t,n)=>[...t,...Array.from(n.querySelectorAll(O))],[]),N="function"!=typeof p&&e(p,(t,n)=>l({...r,[_]:t},_,!1,n),E)(r[_]||{},m,u+1,x||[],y,C),S=t=>function(n,o=n){return o===r[_]?o:l.call(this,N?o:p.call(this,r,o===_CURRENT?r[_]:o),_,t,m)},T=S();if(d.push([_,b?S(!0):N?s:S(),b]),$||O.startsWith("on")){const t=($||O).replace(/(on)?(.+)/,"$2").toLowerCase();E.forEach(n=>{n.addEventListener(t,T)})}return t[a||"set_"+_]=t=>T(t)[_],Object.defineProperty(t,_,{get:()=>N||r[_],set:t=>T(t)[_]})},w=Object.entries(i).reduce(p,{[t]:d});return 1==u?Object.defineProperty(y.reduce(p,w),"state",{get:()=>r}):w};export default e;