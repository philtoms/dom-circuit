const t=Symbol(),n="undefined"!=typeof window&&window.document,e=(n,[o,...i])=>i.length?e(n[o],i):n[o]&&n[o][t];export const _CURRENT=Symbol();const o=[".","#",""],i=(r,c,s)=>(u,f="",d=[],y=[],b)=>{s||"function"==typeof c||(s=c||[],c=!1);const l=function(t,n,e,o){return e?c(u=t,o):u=void 0===t?u:d.reduce((e,[o,i,r])=>r?i.call(this,e)&&e:o in u&&t[o]===u[o]?e:o===n?t:o in t?i.call(this,e,t[o]):e,u),c?c(u,o):u},p=(t,[r,p,w])=>{const[a,h,R,g,j]=r.match(/(([\w]+):)?(\s*(.+))?/),[O,m]=j.split("@"),v=!(O in u)&&R||O.replace(/[#\.\-\[\]\(\)\"\=\^\&\/]/g,""),x=`${f}/${v}`;let C=O.startsWith("/")&&e(t,O.slice(1).split("/"));const E=!w&&O.startsWith("/");if(E)C=[],y.push([r,p,C]);else if(C)return w.forEach(t=>C.push(t)),t;const N=O?[].concat(s||n).reduce((t,n)=>{return[...t,...Array.from((e=n,i=O,o.reduce((t,n)=>t.length?t:e.querySelectorAll(n+i),[])))];var e,i},[]):s,S="function"!=typeof p&&i(p,(t,n)=>l({...u,[v]:t},v,!1,n),N)(u[v]||{},x,C||[],y,E);function T(t){return t===u[v]?t:l.call(this,S?t:p.call(this,u,t===_CURRENT?u[v]:t),v,b,x)}return d.push([v,S?c:T,b]),m&&N.forEach(t=>{t.addEventListener(m,T)}),t[R||v]=t=>T(t)[v],S?Object.defineProperty(t,v,{get:()=>S||u[v]}):t},w=Object.entries(r).reduce(p,{[t]:d});return f?w:Object.defineProperty(y.reduce(p,w),"state",{get:()=>u})};export default i;